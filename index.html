<html>

<head>
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">

</head>
<div id='allContainer'>

    <div id='logo'><img src='./small-Star-Wars-Logo.png'></div>
    <div id="scrollmenu" class="scrollmenu">
        <a href='#' id='filmsTitle'>Films</a>
        <a href='#' id='peopleTitle'>People</a>
        <a href='#' id='starshipsTitle'>Starships</a>
        <a href='#' id='vehiclesTitle'>Vehicles</a>
        <a href='#' id='speciesTitle'>Species</a>
        <a href='#' id='planetsTitle'>Planets</a>

    </div>


    <h1 id='header'>Two Equal Columns</h1>
    <div id='loading' class='loading overlay'>
        Loading...
    </div>
    <img id='image' src="./logo.jpg" class="loading overlay"></img>


    <div class="row">
        <div class="column">
            <div id='div'>
                <ol id="list"></ol>
            </div>
        </div>
        <div class="column">
            <h2 id='detailsTitle'>Column 2</h2>
            <ul id='details'></ul>
        </div>
    </div>

</div>

<script>
    async function test() {
        console.log('start timer');
        document.getElementById('image').classList.add('active');
        await new Promise(resolve => setTimeout(resolve, 5000));
        document.getElementById('image').classList.remove('active');
        console.log('after 1 second');
    }

    test();

    var films = [];
    var people = [];
    function delay(time) {
        return new Promise(resolve => setTimeout(resolve, time));
    }
    const url = 'https://swapi.dev/api/';





    async function loadData(type, id) {
        const response = await fetch(`${url}${type}/${id}/`);
        // await delay(5000);

        const data = await response.json();
        if (response.status != 404) {
            var li = document.createElement("li");
            if (type == 'films') {
                li.appendChild(document.createTextNode(id + "  " + data.title));
                li.className = 'item';

            }
            else {
                li.appendChild(document.createTextNode(id + "  " + data.name));
                li.className = 'item';
            }
            // document.getElementById(`${type}`).appendChild(li);
            document.getElementById('list').appendChild(li);
        }
        console.log(data.title, id);
        document.getElementById('header').innerHTML = type + "  ";
        document.getElementById('header').append(counter);
        document.getElementById('loading').innerHTML = "Loading\n" + type + "  " + counter;
    }


    // for (let i = 1; i <= 83; i++) {
    //     loadData('films', i);
    //     loadData('people', i);
    //     loadData('starships', i);
    //     loadData('vehicles', i);
    //     loadData('species', i);
    //     loadData('planets', i);

    // }

    document.getElementById("list").addEventListener("click", function (e) {
        if (e.target && e.target.matches("li.item")) {
            // e.target.className = "foo"; // new class name here
            // id='detailsTitle'
            document.getElementById('detailsTitle').innerHTML = e.target.innerText;
            // loadList(e.target.innerText);
            // alert("clicked " + e.target.innerText);
        }
    });

    // document.getElementById("people").addEventListener("click", function (e) {
    //     if (e.target && e.target.matches("li.item")) {
    //         // e.target.className = "foo"; // new class name here
    //         alert("clicked " + e.target.innerText);
    //     }
    // });

    document.getElementById("scrollmenu").addEventListener("click", function (e) {
        if (e.target && e.target.matches("a")) {
            // if (e.target.className != 'foo') {
            document.getElementById('list').innerHTML = "";
            console.log(e.target.innerText);
            document.getElementById('loading').classList.add('active');
            // document.getElementById('loading').style.display = "block";
            // document.getElementById('list').innerHTML = "";
            loadList(e.target.innerText);

            // document.getElementById('loading').style.display = "none";
            // }
            // document.getElementById('loading').classList.remove('active');
            // e.target.className = "foo"; // new class name here
        }
    });



    // document.getElementById("film").addEventListener("click", function () {
    //     loadList('film')
    // });
    let counter = 0;
    async function loadList(type) {
        //         document.getElementById('list').innerHTML = `<div id='loading'>
        //     <h2> Loading...</h2>
        // </div>`;

        switch (type) {
            case 'Films':
                //6 items,  max id: 6

                for (let i = 1; i <= 6; i++) { counter++; await loadData('films', i); }
                document.getElementById('loading').classList.remove('active');

                break;
            case 'People':
                //82 items,  max id: 83
                for (let i = 1; i <= 83; i++) { counter++; await loadData('people', i); }
                document.getElementById('loading').classList.remove('active');

                break;
            case 'Starships':
                //36 items,  max id: 75
                for (let i = 1; i <= 75; i++) { counter++; await loadData('starships', i); }
                document.getElementById('loading').classList.remove('active');

                break;
            case 'Vehicles':
                // 39 items,  max id: 76
                for (let i = 1; i <= 76; i++) { counter++; await loadData('vehicles', i); }
                document.getElementById('loading').classList.remove('active');

                break;
            case 'Species':
                // 37 items,  max id: 37
                for (let i = 1; i <= 37; i++) { counter++; await loadData('species', i); }
                document.getElementById('loading').classList.remove('active');

                break;
            case 'Planets':
                // 60 items,  max id: 60
                for (let i = 1; i <= 60; i++) { counter++; await loadData('planets', i); }
                document.getElementById('loading').classList.remove('active');

                break;
            default:
                alert("Click on one of the titles to show the list!");

        }
    }
</script>

</html>